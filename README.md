# Галактическая аналитика

Веб-приложение для анализа и генерации CSV-файлов с галактическими отчетами.

## Технологии

- **Фреймворк:** [React 19](https://react.dev/)
- **Сборщик:** [Vite](https://vitejs.dev/)
- **Язык:** [TypeScript](https://www.typescriptlang.org/)
- **Управление состоянием:** [Zustand](https://github.com/pmndrs/zustand)
- **Роутинг:** [React Router](https://reactrouter.com/)
- **Стилизация:** CSS Modules и глобальные CSS-переменные
- **Тестирование:**
  - **Unit/Component:** [Vitest](https://vitest.dev/), [React Testing Library](https://testing-library.com/docs/react-testing-library/intro/)
  - **E2E:** [Playwright](https://playwright.dev/)
- **Линтинг:** [ESLint](https://eslint.org/)

## Инструкции по запуску

1.  Установите зависимости:

    ```sh
    npm install
    ```

2.  Запустите проект в режиме разработки:

    ```sh
    npm run dev
    ```

3.  Для сборки проекта:

    ```sh
    npm run build
    ```

4.  Для предпросмотра собранного проекта:
    ```sh
    npm run preview
    ```

## Тестирование

Проект покрыт двумя типами тестов для обеспечения качества и стабильности кода.

### Unit-тесты и Компонентные тесты

Используется связка **Vitest** и **React Testing Library**. Тесты сфокусированы на проверке:

- **Корректности работы UI-компонентов:** рендеринг, реакция на действия пользователя.
- **Бизнес-логики в сервисах и хуках:** валидация данных, управление состоянием.

- **Запустить только Unit-тесты:**
  ```sh
  npm run test:unit
  ```

### E2E-тесты

Используется **Playwright** для эмуляции реальных пользовательских сценариев в браузере. Тесты проверяют ключевые пользовательские пути:

- Загрузка и анализ CSV-файла.
- Генерация и скачивание отчета.
- Навигация по страницам и работа с историей.

Тест-кейсы для E2E-тестов описаны в файле: [`tests/e2e/README.md`](/tests/e2e/README.md).

- **Запустить только E2E-тесты:**
  ```sh
  npm run test:e2e
  ```

### Запуск всех тестов

Для полного прогона всех тестов (Unit + E2E) выполните команду:

```sh
npm test
```

## Описание архитектуры

Проект построен на базе Feature-Sliced Design, где логика разделена по функциональным модулям.

- **`src/`** — основной каталог исходного кода.
  - **`api/`** — низкоуровневый слой для взаимодействия с внешними источниками. Например, `fetch`-запросы к бэкенду или работа с `localStorage`.
  - **`assets/`** — статические ресурсы (логотипы, иконки и др.).
  - **`components/`** — переиспользуемые UI-компоненты без бизнес-логики (кнопки, поля ввода, лоадеры).
  - **`pages/`** — компоненты страниц, соответствующие маршрутам приложения (Аналитика, Генератор, История). Собирают в себе компоненты и сервисы.
  - **`services/`** — слой бизнес-логики. Обрабатывает данные, полученные из `api`, перед их передачей в состояние или компоненты.
  - **`shared/`** — вспомогательные утилиты, хуки и функции, используемые в разных частях приложения.
  - **`store/`** — глобальное состояние приложения.

### Архитектура состояния

Используется **Zustand** для управления состоянием. Состояние разделено на "слайсы" (`analytics`, `generator`, `history`), каждый из которых отвечает за свою часть приложения. Такой подход изолирует логику и упрощает управление состоянием в крупных проектах. Каждый слайс содержит `state` и `actions` для своей функциональности.

### Роутинг

Реализован с помощью `react-router-dom`. Основные маршруты:

- `/` — страница аналитики (`AnalyticsPage`).
- `/generate` — страница генерации CSV (`GeneratorPage`).
- `/history` — история обработанных файлов (`HistoryPage`).

### Стилизация

Используются **CSS-модули** для изоляции стилей компонентов, что предотвращает конфликты имен классов. Глобальные стили и CSS-переменные (для цветов, отступов, шрифтов) определены в `src/index.css` для поддержания консистентности дизайна.

### Работа с файлами

- **Анализ:** Пользователь загружает CSV-файл через Drag-and-Drop или диалоговое окно. `AnalyticsService` валидирует файл и отправляет его в `AnalyticsApi` для обработки на бэкенде. Результаты анализа отображаются на странице.
- **Генерация:** `GeneratorService` запрашивает файл у `GeneratorApi` и инициирует его скачивание в браузере пользователя.
- **История:** `HistoryApi` использует `localStorage` для хранения записей об обработанных отчетах, позволяя пользователю просматривать историю загрузок и генераций.
